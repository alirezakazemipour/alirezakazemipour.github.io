

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Some cool questions - Alireza Kazemipour</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Alireza Kazemipour">
<meta property="og:title" content="Some cool questions">


  <link rel="canonical" href="https://alirezakazemipour.github.io/posts/2025/10/cl-qstns/">
  <meta property="og:url" content="https://alirezakazemipour.github.io/posts/2025/10/cl-qstns/">



  <meta property="og:description" content="\(\begin{align*}  \newcommand{\I}{\mathbb{1}}  \newcommand{\R}{\mathbb{R}}  \newcommand{\Q}{\mathbb{Q}}  \newcommand{\N}{\mathbb{N}}  \DeclareMathOperator{\EE}{\mathbb{E}}  \DeclareMathOperator{\PP}{\mathbb{P}}  \newcommand{\Ev}[1]{\EE\left[ #1 \right]}  \newcommand{\Pr}[1]{\PP\left( #1 \right)}  \end{align*}\)  An elementary theorem in number theory states that if two integers $m$ and $n$ are relatively prime (i.e., greatest common divisor equal to 1 ), then there exist integers $x$ and $y$ (positive or negative) such that $mx + ny = 1$. Using this theorem show the following:            A If $m$ and $n$ are relatively prime then the set {$xm + ny : x, y$ positive integers} contains all but a finite number of the positive integers.            B. Let $J$ be a set of nonnegative integers whose greatest common divisor is $d$. Suppose also that $J$ is closed under addition, $m, n \in J \Rightarrow m + n \in J$. Then $J$ contains all but a finite number of integers in the set {$0, d, 2d,\dots$}.Source: Introduction to Stochastic Processesanswer.Part (A).First, note that if we want to contain only positive integers, then $n$ and $m$ must be nonnegative. If one of them is negative and the other is positive, we would inevitably contain the whole integers. Also, to rule out the trivial case, let us assume $n, m \geq 1$.Since $\mathsf{gcd} (n, m) = 1$, the great common divisor of any multiples of $n$ from $1n$ to $mn$ with $m$ is also one. In other words, the set {$n, 2n, \dots, mn$} forms the residue system modulo $m$. Let $N$ be any nonzero integer, we have $N \equiv ny \pmod m$, where $1 \leq y \leq m$. Equivalently, we can say $N - ny = mx$ for some integer $x$.We know that since $1 \leq y \leq m$, $y$ is positive. On the other hand, if $N \geq mn + 1$, then $x = \frac{N - ny}{m} &gt; 0$, hence $x$ is also positive. Therefore, we just proved that for positive integers $x$ and $y$, all positive integers bigger than $mn$ are in the set described in the question.Part (B).Consider the set $J’ =$ {$\frac{j}{d} \mid j \in J$}. If we show for any integer $k$ in $J’$ that is bigger than some threshold $K$, all but a finite number of nonnegative integers are in $J’$, then we can conclude for any integer $k$ in $J$ that is bigger than $Kd$, all but a finite number of nonnegative integers are in $J$By construction, the greatest common divisor of $J’$s elements is one and also $J’$ is closed under addition. Now, consider an arbitrary element in $J’$ and let us denote it by $a$. The set of remainder of $J’$s elements when divided by $a$ is $R = $ {$j’ \pmod{a} \mid j’ \in J’$}. Since the greatest common divisor of $J’$ is one, the greatest common divisor of $R$ is also one. Therefore, $R$ forms the residue system modulo $a$, i.e., $R = $ {$0, 1, \dots a - 1$}, where for each element of $r \in R$ there exits at least one element in $J’$ denoted by $j’_r$ such that $j’_r \equiv r \pmod{a}$. Let us denote the largest representative of these elements by $K$:[K = \max \left{j’0, j’_1, \dots j’{a - 1} \right}.]Now we show that any integer bigger than $K$ is in $J’$. Let $k$ be an integer bigger than $K$ and let its remainder when divided by $a$ be $r$, i.e., $k = r \pmod{ a}$. We know that there is an element in $J’$ with same remainder, i.e., $j’_r$, therefore:[k = j’_r + c\cdot a,]for some integer $c$. Since $k &gt; M$ and $j’_r \leq M$, $k - j’_r &gt; 0$ and $c \cdot a$ is positive multiple of $a$.          Since $j’_r, a \in J’$, and $J’$ is closed under addition, both $j’_r$ and $c \cdot a = \underbrace{a + a + \dots + a}_{c\, \mathrm{times}}$ are in $J’$.          Therefore, their sum, $k$, must also be in $J’$. This proves that $J’$ contains all integers greater than $K$.         Consequently, $J$ contains {$(K + 1)d, (K + 2)d, \dots$}, which completes the proof.  What is an ergodic Markov chain?answer.It’s an aperiodic, irreducible, and recurrent Markov chain:Aperiodic:        The period of the chain is one.Irreducible:        If there is only one communication class, i.e., if for all $i, j$ there exists an $n = n(i,j)$ with $P_n(i,j) &gt; 0$, then the chain is called irreducible.Recurrent:        If the chain starts in a transient class (set of states), then with probability one it eventually leaves this class and never returns. Classes with this property are called transient classes and the states are called transient states. Other classes are called recurrent classes with recurrent states. A Markov chain starting in a recurrent class never leaves that class.  Why is the left eigenvector of a transition matrix with the eigen value of one equal to the stationary distribution of the Markov chain modelled by the transition matrix?answer.Suppose $\bar{\pi}$ is the stationary distribution and $P$ is the transition matrix. Then, we know that since all rows of $P^\infty$ are the same, then for any initial any probability vector $\bar{v}$ we have[\bar{\pi} = \lim_{n \to \infty} \bar{v}P^n.]Hence, we have,\(\bar{\pi} = \lim_{n \to \infty} \bar{v}P^{n + 1} = \left(\lim_{n \to \infty} \bar{v}P^{n}\right)P = \bar{\pi}P.\)        The above display is a left eigenvector of $P with eigenvalue one.Source: Introduction to Stochastic Processes  Prove that every state in an irreducible Markov chain has the same period.The period of state $i$ is defined as the greatest common divisor of the set $J_i :=$ {$n \geq 1: P_n(i, i) &gt;0$}. Not that $J_i$ is closed under addition because $P_{n +m} (i, i) = \sum_k P_n(i, k) P_m(k, i) \geq P_n(i, i) P_m(i, i) &gt; 0$. Let $d$ be the greatest common divisor of $J_i$. We have shown before that $J_i$ contains all but a finite number of integers. Hence, $J_i$ contains $md$ for all $m$ greater than some integer $M$.Let $j$ be another state and $n,m$ such that $P_n(i, j), P_m(j, i) &gt; 0$ (chain is irreducible). Clearly $n + m \in J_i$ and $m + n \in J_j$. If $l \in J_j$, then[P_{n+m+l}(i, j) \geq P_{n}(i, j)P_l(j, j)P_m(j, i) &gt; 0.]Therefore, $n+m+l \in J_i, J_j$. $d$ used to divide $n + m$, now we showed that it must divide $l$ as well.       So, we have just shown that if $d $divides every element of $J_i$      then it divides every element of $J_j$. From this we see that all states have the same period.Source: Introduction to Stochastic Processes—  - Consider the Markov chain with state space {1, 2, 3, 4, 5} and matrix[P = \begin{pmatrix}    0 &amp; 1/3 &amp; 2/3 &amp; 0 &amp; 0 \    0 &amp; 0 &amp; 0 &amp; 1/4 &amp; 3/4 \    0 &amp; 0 &amp; 0 &amp; 1/2 &amp; 1/2 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0    \end{pmatrix}]What are $P_{1000}(2, 1 ), P_{1000}(2, 2), P_{1000}(2, 4)$?Due to the structure of the chain at no time step there would be probability for transitioning from state 2 to state 1, nor from state 2 to itself. Hence, $P_{1000}(2, 1) = P_{1000}(2, 2) = 0$On the other hand to compute $P_{1000}(2, 4)$, since the chain is periodic with the period of three and the remainder of $1000$ when divided by $3$ is one, the same as number $4$, hence using Python software we raise the matrix to the power of $4$ instead, and $P_{1000}(2, 4) \approx P_4(2, 4) \approx  0.4167$.[\begin{equation}        P_4 = \begin{pmatrix}      0 &amp; 0.3333 &amp; 0.6665 &amp; 0 &amp; 0\      0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835 \      0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835\      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0         \end{pmatrix}    \end{equation}]Source: Introduction to Stochastic Processes  Let $X_1, X_2,\dots$ be the successive values from independent rolls of a standard six-sided die. Let $S_n= X_1 + \dots + X_n$. Let[T_1 = \min {n \geq 1: S_n \, \text{is divisible by 8} },][T_2 = \min{n \geq 1: S_{n - 1}\, \text{is divisible by 8}}.]Find $\mathbb{E}[T_1]$ and $\mathbb{E}[T_2]$. (Hint: consider the remainder of $S_n after division by 8 as a Markov chain.)answer.The state space of the chain comprises ${0, 1, 2, 3, 4, 5, 6, 7}$. Let $g(i)$ denotes the expected number of rolls until the chain reaches state zero, while starting at state $i$. We have that $g(0) = 0$. Definitely we won’t reach the state $0$ with just one roll because the outcome would be among $1$ and $6$. Hence,[\begin{equation}        \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right).    \end{equation}]On the other hand,[\begin{equation}        \sum_{i=1}^7g(i) = \sum_{i=1}^7 \left(1 + \frac{1}{6}\sum_{j=1}^6 g\left(i + j \bmod{8}\right) \right).    \end{equation}]That is, the expected number of rolls starting from state $i \neq 0$ is equal to rolling the die and the expected number of rolls of the resulting state. We rearrange the summations to get:[\begin{equation}        \sum_{i=1}^7g(i) =  7 + \frac{1}{6}\sum_{j=1}^6\sum_{i=7}^6 g(i + j \bmod{8}).    \end{equation}]Now for each fixed $j$, $(i + j \bmod{8})$ is a permutation of ${0, 1, 2, 3, 4, 5, 6, 7}$ excluding the number $j$.     Hence, by denoting $S := \sum_{i = 1}^7 g(i)$, we have:[\begin{align}        S = 7 + \frac{1}{6}\sum_{j=1}^6(S - g(j)) \Rightarrow \sum_{j = 1}^6 g(j) = 42.    \end{align}]Therefore,[\begin{equation}        \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right) = 8.    \end{equation}]For computing $\mathbb{E}[T_2]$, we only need to roll the die once, because the sum of the random variables before the first roll is zero, so $S_{1 - 1} = S_0 = 0$, and $0$ is divisible by 8.Source: Introduction to Stochastic Processes  Let $X_n, Y_n$ be independent Markov chains with state space {$0, 1, 2$} and transition matrix[P = \begin{pmatrix}    1/2 &amp; 1/4 &amp; 1/4 \    1/4 &amp; 1/4 &amp; 1/2 \    0 &amp; 1/2 &amp; 1/2    \end{pmatrix}.]Suppose $X_0 = 0, Y_0 = 2$ and let[T = \inf{n: X_n = Y_n}.](A) Find $\mathbb{E}[T]$.(B) What is $\mathbb{P}{X_T = 2}$?(C) In the long run, what percentage of the time are both chains in the same state?    [Hint: consider the nine-state Markov chain $Z_n = (X_n, Y_n$).]answer.Part(A).We need to set up a recursive formula connecting the expected number of steps until two chains meet.Let $g(i, j)$ be the expected number of steps until the meeting time, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $g(k, k) = 0,: k \in {0, 1, 2}$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:[\begin{equation}        g(i, j) = 1 + \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)g(k, j).    \end{equation}]This gives a set of 6 equations with 6 unknowns     ($g(0, 1), g(0, 2), g(1, 0), g(1, 2), g(2, 0),\, \mathrm{and}\, g(2, 1)$) as follows:[\begin{align}        g(0, 1) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)  \        g(0, 2) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)        \        g(1, 0) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \        g(1, 2) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \        g(2, 0) &amp; = 1 + 0\cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2) \        g(2, 1) &amp; = 1 + 0 \cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2).    \end{align}]Solving this system of equations gives us: $g(0, 2) = \frac{118}{35} \approx 3.37$.Part (B).We need to set up a recursive formula connecting how the chains can meet at state 2 while starting at state 0 and 2 respectively.Let $h(i, j)$ be the probability of first meeting at state 2, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $h(1, 1) = h(0 , 0) = 0$ (first meeting should be at state 2), and $h(2, 2) = 1$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:[\begin{equation}        h(i, j) = \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)h(k, j).    \end{equation}]This gives a set of 6 equations with 6 unknowns ($h(0, 1), h(0, 2), h(1, 0), h(1, 2), h(2, 0),\, \mathrm{and}\, h(2, 1)$) as follows:[\begin{align}        h(0, 1) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)  \        h(0, 2) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)        \        h(1, 0) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \        h(1, 2) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \        h(2, 0) &amp; = 0\cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2) \        h(2, 1) &amp; = 0 \cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2).    \end{align}]Solving this system of equations gives us: $h(0, 2) = \frac{15}{28} \approx 0.535$.Part (C).Since the chains are independent, we need to multiple their invariant distributions for states ${1, 2, 3}$. Let us find the invariant distribution by solving $\bar{\pi} = \bar{\pi}P$:[\begin{equation}        \begin{pmatrix}            \bar{\pi}_1 \            \bar{\pi}_2 \            \bar{\pi}_3        \end{pmatrix} =        \begin{pmatrix}            \bar{\pi}_1 \            \bar{\pi}_2 \            \bar{\pi}_3        \end{pmatrix}^\top \begin{pmatrix}            1/2 &amp; 1/4 &amp; 1/4  \            1/4 &amp; 1/4 &amp; 1/2 \            0 &amp; 1/2 &amp; 1/2        \end{pmatrix}        \quad \mathrm{and} \quad \bar{\pi}_1 + \bar{\pi}_2 + \bar{\pi}_3 = 1.    \end{equation}]The solution of this equation is: $\bar{\pi} = \frac{1}{11}(2, 4, 5)$. Hence, the probability that both chains spend time at the same states in a long run is equal to: $\frac{1}{11^2}(4 + 16 + 25) = \frac{45}{121}$.Source: Introduction to Stochastic Processes  Let $X_n$ be a Markov chain on state space {1, 2, 3, 4, 5} with transition matrix[P = \begin{pmatrix}    0 &amp; 1/2 &amp; 1/2 &amp; 0 &amp; 0\    0 &amp; 0 &amp; 0 &amp; 1/5 &amp; 4/5 \    0 &amp; 0 &amp; 0 &amp; 2/5 &amp; 3/5 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \    1/2 &amp; 0 &amp; 0 &amp; 0 &amp; 1/2    \end{pmatrix}](A) Suppose $X_0 = 1$. What is the expected number of steps until the chain is in state 4?(B) Suppose $X_0 = 1$. What is the probability that the chain will enter state 5 before it enters state 3?answer.Part (A).We need to set up a recursive formula connecting the expected number of steps until reaching state 4 for each distinct state. Let $g(i)$ be the expected number of steps until reaching state $4$, when the chain has started at state $i$. We have that $g(4) = 0$. For all other state we have that:[\begin{equation}        g(i) = 1 + \sum_{j=0, j \neq 4}^5P(i, j)g(j).    \end{equation}]This gives a set of 4 equations with 4 unknowns ($g(1), g(2), g(3),\, \mathrm{and}\, g(5)$) as follows:[\begin{align}        g(5) &amp; = 1 + \frac{1}{2}g(0) + \frac{1}{2}g(5) \        g(3) &amp; = 1 + \frac{2}{5}g(4) + \frac{3}{5}g(5) \        g(2) &amp; = 1 + \frac{1}{5}g(4) + \frac{4}{5}g(5) \        g(1) &amp; = 1 + \frac{1}{2}g(2) + \frac{1}{2}g(3)    \end{align}]Solving this system of equations gives us: $g(1) = \frac{34}{3}$.Part (B).We need to set up a recursive formula connecting how the chain can hit state 5 before state 3, while starting at state 1.Let $h(i)$ be the probability that the chain hits state $5$ before state 3, when the chain has started at state $i$. We have that $h(5) =1$ and $h(3) = 0$. For all other state we have that:[\begin{equation}        h(i) = \sum_{j=1}^5P(i, j)h(j).    \end{equation}]This gives a set of 3 equations with 3 unknowns ($h(1), h(2),\, \mathrm{and}\, h(4)$) as follows:[\begin{align}        h(4) &amp; = h(1) \        h(2) &amp; = \frac{1}{5}h(4) + \frac{4}{5}h(5) =  \frac{1}{5}h(4) + \frac{4}{5}\        h(1) &amp; = \frac{1}{2}h(2) + \frac{1}{2}h(3) = \frac{1}{2}h(2)    \end{align}]Solving this system of equations gives us: $h(1) = \frac{4}{9}$.Source: Introduction to Stochastic Processes  Theorem. Suppose the state space $S$ and the action space $A$ are finite. Then, there exits a deterministic stationary Markov Blackwell optimal policy.Proof. Let $\Pi^\mathrm{MD}$ be the set of all deterministic Markov polices for an MDP with finite state and action spaces. Since $\Pi^\mathrm{MD}$ is finite, there exits a sequence of discount factors {$\gamma_n$} converging to one for which there exits a $\pi^* \in \Pi^\mathrm{MD}$ with $\left(\pi^*\right)^\infty = (\pi, \pi, \dots)  = (\pi_0, \pi_1, \dots)$ (as the stationary policy) being discount optimal for all $\gamma_n$.The reason the aforementioned fact is true is that since $\Pi^\mathrm{MD}$ finite and $0 \leq \gamma &lt;1$ is infinite, due to pigeonhole principle some optimal policies are shared for some discount factors. Therefore, we can pick a subsequence of discount factors that increases toward one, which will have an associated optimal policy.With having the above fact in mind, for each $\pi \in \Pi^\mathrm{MD}$,[v_\gamma^{\left(\pi^*\right)^\infty}(s) - v_\gamma^{\pi^\infty}(s) \geq 0,]for all states, $\gamma = \gamma_n$ and $n = 1, 2, \dots$ . Each function on L.H.S. is a rational function of $\gamma$, so is their difference. Hence, the difference is zero for all $\gamma$, or equals zero for at most finitely many $\gamma$s. Therefore, there exists a $\gamma_\pi &lt; 1$ for which the above display holds for $\gamma_\pi \leq \gamma &lt; 1$. Since $\Pi^\mathrm{MD}$ is finite the above displays holds for all $\gamma^* \leq \gamma &lt; 1$ where $\gamma^* = \max_\pi \gamma_{\pi}$.Now that we have fixed $\gamma$, by virtue of the existence of a deterministic stationary Markov policy in the discounted setting, the result follows. $\square$I’ve been concise and incomplete for this theorem. I’ll add supplementary details one day that I stumbled on this post. :DSource: Markov Decision Processes: Discrete Stochastic Dynamic Programming  Let $\Omega$ be a measurable set, and let $f: \Omega \to [0, \infty]$ be a non-negative measurable function. Prove that we have $0 \leq \int_\Omega f \leq \infty$. Furthermore, we have $\int_\Omega f = 0$ if and only if $f(x) = 0$ for almost every $x \in \Omega$.Proof. Since $f$ is a non-negative measurable function, we have that[\int_\Omega f = \sup {\int_\Omega s: s \text{ is non-negative, simple and dominated by } f }.]Step 1: $0 \leq \int_\Omega \leq \infty$.Consider a fixed $s$. Since $s$ is simple, $\int_\Omega s = \sum_{j = 1}^N c_j \cdot m(E_j)$, where $N \in \mathbb{N}, c_j &gt; 0, m: \Omega \to \mathbb{R}^*$ is the Lebesgue measure, $E_1, \dots, E_N \in  \Omega$, and $E_i \cap E_j = \varnothing$ for all $i, j \in [N], \mathrm{and}\, i \neq j$. The sum of non-negative terms on theextended real line $\mathbb{R}^*$ is in $[0, \infty]$, hence is their supremum.Step 2: If $f = 0$ a.e., then $\int_\Omega f = 0$.Since $f$ dominates $s$, then $0 \leq s(x) \leq f(x)$, for all $x \in \Omega$. If $f(x) = 0$ for almost every $x \in \Omega$, then $s = 0$ a.e., hence $\int_\Omega s = 0$, and consequently $\sup \int_\Omega s = 0$.Step 3: If $\int_\Omega f = 0$, then $f = 0$ a.e.Consider the set[E_j := {x \in \Omega: f(x) &gt; \frac 1j }, \quad j \geq 1.]The function $s_j := \frac 1j \mathbb{1}_{E_j}$ is simple and also dominated by $f$ because $0 \leq s_j \leq f$. By Step 1, we have $\frac 1j m(E_j) = \int_\Omega s_j \leq \int_\Omega f = 0$. This means $m(E_j) = 0$ for all $j$. The domain of $f$ where it is non zero is[\Omega’ := {x : f(x) &gt; 0 } = \cup_{j = 1}^\infty E_j.]By the subadditivity property of the Lebesgue measure we have[m\left(\Omega’ \right) = \sum_{j = 1}^\infty m(E_j) = 0 \Rightarrow f = 0: \mathrm{a.e.}]Source: Analysis II">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2025-10-31T00:00:00-07:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Alireza Kazemipour",
      "url" : "https://alirezakazemipour.github.io",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://alirezakazemipour.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="Alireza Kazemipour Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://alirezakazemipour.github.io/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="https://alirezakazemipour.github.io/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="https://alirezakazemipour.github.io/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="https://alirezakazemipour.github.io/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="https://alirezakazemipour.github.io/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="https://alirezakazemipour.github.io/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="https://alirezakazemipour.github.io/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="https://alirezakazemipour.github.io/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="https://alirezakazemipour.github.io/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="https://alirezakazemipour.github.io/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="https://alirezakazemipour.github.io/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="https://alirezakazemipour.github.io/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="https://alirezakazemipour.github.io/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="https://alirezakazemipour.github.io/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="https://alirezakazemipour.github.io/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="https://alirezakazemipour.github.io/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="https://alirezakazemipour.github.io/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="https://alirezakazemipour.github.io/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="https://alirezakazemipour.github.io/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="https://alirezakazemipour.github.io/">Alireza Kazemipour</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://alirezakazemipour.github.io/misc/">Miscellaneous</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://alirezakazemipour.github.io/unfin/">Unfinished ideas</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://alirezakazemipour.github.io/crs_prjcts/">Course projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://alirezakazemipour.github.io/year-archive/">Journal</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  



  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Some cool questions">
    <meta itemprop="description" content="\(\begin{align*}  \newcommand{\I}{\mathbb{1}}  \newcommand{\R}{\mathbb{R}}  \newcommand{\Q}{\mathbb{Q}}  \newcommand{\N}{\mathbb{N}}  \DeclareMathOperator{\EE}{\mathbb{E}}  \DeclareMathOperator{\PP}{\mathbb{P}}  \newcommand{\Ev}[1]{\EE\left[ #1 \right]}  \newcommand{\Pr}[1]{\PP\left( #1 \right)}  \end{align*}\)  An elementary theorem in number theory states that if two integers $m$ and $n$ are relatively prime (i.e., greatest common divisor equal to 1 ), then there exist integers $x$ and $y$ (positive or negative) such that $mx + ny = 1$. Using this theorem show the following:            A If $m$ and $n$ are relatively prime then the set {$xm + ny : x, y$ positive integers} contains all but a finite number of the positive integers.            B. Let $J$ be a set of nonnegative integers whose greatest common divisor is $d$. Suppose also that $J$ is closed under addition, $m, n \in J \Rightarrow m + n \in J$. Then $J$ contains all but a finite number of integers in the set {$0, d, 2d,\dots$}.Source: Introduction to Stochastic Processesanswer.Part (A).First, note that if we want to contain only positive integers, then $n$ and $m$ must be nonnegative. If one of them is negative and the other is positive, we would inevitably contain the whole integers. Also, to rule out the trivial case, let us assume $n, m \geq 1$.Since $\mathsf{gcd} (n, m) = 1$, the great common divisor of any multiples of $n$ from $1n$ to $mn$ with $m$ is also one. In other words, the set {$n, 2n, \dots, mn$} forms the residue system modulo $m$. Let $N$ be any nonzero integer, we have $N \equiv ny \pmod m$, where $1 \leq y \leq m$. Equivalently, we can say $N - ny = mx$ for some integer $x$.We know that since $1 \leq y \leq m$, $y$ is positive. On the other hand, if $N \geq mn + 1$, then $x = \frac{N - ny}{m} &gt; 0$, hence $x$ is also positive. Therefore, we just proved that for positive integers $x$ and $y$, all positive integers bigger than $mn$ are in the set described in the question.Part (B).Consider the set $J’ =$ {$\frac{j}{d} \mid j \in J$}. If we show for any integer $k$ in $J’$ that is bigger than some threshold $K$, all but a finite number of nonnegative integers are in $J’$, then we can conclude for any integer $k$ in $J$ that is bigger than $Kd$, all but a finite number of nonnegative integers are in $J$By construction, the greatest common divisor of $J’$s elements is one and also $J’$ is closed under addition. Now, consider an arbitrary element in $J’$ and let us denote it by $a$. The set of remainder of $J’$s elements when divided by $a$ is $R = $ {$j’ \pmod{a} \mid j’ \in J’$}. Since the greatest common divisor of $J’$ is one, the greatest common divisor of $R$ is also one. Therefore, $R$ forms the residue system modulo $a$, i.e., $R = $ {$0, 1, \dots a - 1$}, where for each element of $r \in R$ there exits at least one element in $J’$ denoted by $j’_r$ such that $j’_r \equiv r \pmod{a}$. Let us denote the largest representative of these elements by $K$:[K = \max \left{j’0, j’_1, \dots j’{a - 1} \right}.]Now we show that any integer bigger than $K$ is in $J’$. Let $k$ be an integer bigger than $K$ and let its remainder when divided by $a$ be $r$, i.e., $k = r \pmod{ a}$. We know that there is an element in $J’$ with same remainder, i.e., $j’_r$, therefore:[k = j’_r + c\cdot a,]for some integer $c$. Since $k &gt; M$ and $j’_r \leq M$, $k - j’_r &gt; 0$ and $c \cdot a$ is positive multiple of $a$.          Since $j’_r, a \in J’$, and $J’$ is closed under addition, both $j’_r$ and $c \cdot a = \underbrace{a + a + \dots + a}_{c\, \mathrm{times}}$ are in $J’$.          Therefore, their sum, $k$, must also be in $J’$. This proves that $J’$ contains all integers greater than $K$.         Consequently, $J$ contains {$(K + 1)d, (K + 2)d, \dots$}, which completes the proof.  What is an ergodic Markov chain?answer.It’s an aperiodic, irreducible, and recurrent Markov chain:Aperiodic:        The period of the chain is one.Irreducible:        If there is only one communication class, i.e., if for all $i, j$ there exists an $n = n(i,j)$ with $P_n(i,j) &gt; 0$, then the chain is called irreducible.Recurrent:        If the chain starts in a transient class (set of states), then with probability one it eventually leaves this class and never returns. Classes with this property are called transient classes and the states are called transient states. Other classes are called recurrent classes with recurrent states. A Markov chain starting in a recurrent class never leaves that class.  Why is the left eigenvector of a transition matrix with the eigen value of one equal to the stationary distribution of the Markov chain modelled by the transition matrix?answer.Suppose $\bar{\pi}$ is the stationary distribution and $P$ is the transition matrix. Then, we know that since all rows of $P^\infty$ are the same, then for any initial any probability vector $\bar{v}$ we have[\bar{\pi} = \lim_{n \to \infty} \bar{v}P^n.]Hence, we have,\(\bar{\pi} = \lim_{n \to \infty} \bar{v}P^{n + 1} = \left(\lim_{n \to \infty} \bar{v}P^{n}\right)P = \bar{\pi}P.\)        The above display is a left eigenvector of $P with eigenvalue one.Source: Introduction to Stochastic Processes  Prove that every state in an irreducible Markov chain has the same period.The period of state $i$ is defined as the greatest common divisor of the set $J_i :=$ {$n \geq 1: P_n(i, i) &gt;0$}. Not that $J_i$ is closed under addition because $P_{n +m} (i, i) = \sum_k P_n(i, k) P_m(k, i) \geq P_n(i, i) P_m(i, i) &gt; 0$. Let $d$ be the greatest common divisor of $J_i$. We have shown before that $J_i$ contains all but a finite number of integers. Hence, $J_i$ contains $md$ for all $m$ greater than some integer $M$.Let $j$ be another state and $n,m$ such that $P_n(i, j), P_m(j, i) &gt; 0$ (chain is irreducible). Clearly $n + m \in J_i$ and $m + n \in J_j$. If $l \in J_j$, then[P_{n+m+l}(i, j) \geq P_{n}(i, j)P_l(j, j)P_m(j, i) &gt; 0.]Therefore, $n+m+l \in J_i, J_j$. $d$ used to divide $n + m$, now we showed that it must divide $l$ as well.       So, we have just shown that if $d $divides every element of $J_i$      then it divides every element of $J_j$. From this we see that all states have the same period.Source: Introduction to Stochastic Processes—  - Consider the Markov chain with state space {1, 2, 3, 4, 5} and matrix[P = \begin{pmatrix}    0 &amp; 1/3 &amp; 2/3 &amp; 0 &amp; 0 \    0 &amp; 0 &amp; 0 &amp; 1/4 &amp; 3/4 \    0 &amp; 0 &amp; 0 &amp; 1/2 &amp; 1/2 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0    \end{pmatrix}]What are $P_{1000}(2, 1 ), P_{1000}(2, 2), P_{1000}(2, 4)$?Due to the structure of the chain at no time step there would be probability for transitioning from state 2 to state 1, nor from state 2 to itself. Hence, $P_{1000}(2, 1) = P_{1000}(2, 2) = 0$On the other hand to compute $P_{1000}(2, 4)$, since the chain is periodic with the period of three and the remainder of $1000$ when divided by $3$ is one, the same as number $4$, hence using Python software we raise the matrix to the power of $4$ instead, and $P_{1000}(2, 4) \approx P_4(2, 4) \approx  0.4167$.[\begin{equation}        P_4 = \begin{pmatrix}      0 &amp; 0.3333 &amp; 0.6665 &amp; 0 &amp; 0\      0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835 \      0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835\      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \      1 &amp; 0 &amp; 0 &amp; 0 &amp; 0         \end{pmatrix}    \end{equation}]Source: Introduction to Stochastic Processes  Let $X_1, X_2,\dots$ be the successive values from independent rolls of a standard six-sided die. Let $S_n= X_1 + \dots + X_n$. Let[T_1 = \min {n \geq 1: S_n \, \text{is divisible by 8} },][T_2 = \min{n \geq 1: S_{n - 1}\, \text{is divisible by 8}}.]Find $\mathbb{E}[T_1]$ and $\mathbb{E}[T_2]$. (Hint: consider the remainder of $S_n after division by 8 as a Markov chain.)answer.The state space of the chain comprises ${0, 1, 2, 3, 4, 5, 6, 7}$. Let $g(i)$ denotes the expected number of rolls until the chain reaches state zero, while starting at state $i$. We have that $g(0) = 0$. Definitely we won’t reach the state $0$ with just one roll because the outcome would be among $1$ and $6$. Hence,[\begin{equation}        \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right).    \end{equation}]On the other hand,[\begin{equation}        \sum_{i=1}^7g(i) = \sum_{i=1}^7 \left(1 + \frac{1}{6}\sum_{j=1}^6 g\left(i + j \bmod{8}\right) \right).    \end{equation}]That is, the expected number of rolls starting from state $i \neq 0$ is equal to rolling the die and the expected number of rolls of the resulting state. We rearrange the summations to get:[\begin{equation}        \sum_{i=1}^7g(i) =  7 + \frac{1}{6}\sum_{j=1}^6\sum_{i=7}^6 g(i + j \bmod{8}).    \end{equation}]Now for each fixed $j$, $(i + j \bmod{8})$ is a permutation of ${0, 1, 2, 3, 4, 5, 6, 7}$ excluding the number $j$.     Hence, by denoting $S := \sum_{i = 1}^7 g(i)$, we have:[\begin{align}        S = 7 + \frac{1}{6}\sum_{j=1}^6(S - g(j)) \Rightarrow \sum_{j = 1}^6 g(j) = 42.    \end{align}]Therefore,[\begin{equation}        \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right) = 8.    \end{equation}]For computing $\mathbb{E}[T_2]$, we only need to roll the die once, because the sum of the random variables before the first roll is zero, so $S_{1 - 1} = S_0 = 0$, and $0$ is divisible by 8.Source: Introduction to Stochastic Processes  Let $X_n, Y_n$ be independent Markov chains with state space {$0, 1, 2$} and transition matrix[P = \begin{pmatrix}    1/2 &amp; 1/4 &amp; 1/4 \    1/4 &amp; 1/4 &amp; 1/2 \    0 &amp; 1/2 &amp; 1/2    \end{pmatrix}.]Suppose $X_0 = 0, Y_0 = 2$ and let[T = \inf{n: X_n = Y_n}.](A) Find $\mathbb{E}[T]$.(B) What is $\mathbb{P}{X_T = 2}$?(C) In the long run, what percentage of the time are both chains in the same state?    [Hint: consider the nine-state Markov chain $Z_n = (X_n, Y_n$).]answer.Part(A).We need to set up a recursive formula connecting the expected number of steps until two chains meet.Let $g(i, j)$ be the expected number of steps until the meeting time, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $g(k, k) = 0,: k \in {0, 1, 2}$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:[\begin{equation}        g(i, j) = 1 + \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)g(k, j).    \end{equation}]This gives a set of 6 equations with 6 unknowns     ($g(0, 1), g(0, 2), g(1, 0), g(1, 2), g(2, 0),\, \mathrm{and}\, g(2, 1)$) as follows:[\begin{align}        g(0, 1) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)  \        g(0, 2) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)        \        g(1, 0) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \        g(1, 2) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \        g(2, 0) &amp; = 1 + 0\cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2) \        g(2, 1) &amp; = 1 + 0 \cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2).    \end{align}]Solving this system of equations gives us: $g(0, 2) = \frac{118}{35} \approx 3.37$.Part (B).We need to set up a recursive formula connecting how the chains can meet at state 2 while starting at state 0 and 2 respectively.Let $h(i, j)$ be the probability of first meeting at state 2, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $h(1, 1) = h(0 , 0) = 0$ (first meeting should be at state 2), and $h(2, 2) = 1$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:[\begin{equation}        h(i, j) = \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)h(k, j).    \end{equation}]This gives a set of 6 equations with 6 unknowns ($h(0, 1), h(0, 2), h(1, 0), h(1, 2), h(2, 0),\, \mathrm{and}\, h(2, 1)$) as follows:[\begin{align}        h(0, 1) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)  \        h(0, 2) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)        \        h(1, 0) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \        h(1, 2) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \        h(2, 0) &amp; = 0\cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2) \        h(2, 1) &amp; = 0 \cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2).    \end{align}]Solving this system of equations gives us: $h(0, 2) = \frac{15}{28} \approx 0.535$.Part (C).Since the chains are independent, we need to multiple their invariant distributions for states ${1, 2, 3}$. Let us find the invariant distribution by solving $\bar{\pi} = \bar{\pi}P$:[\begin{equation}        \begin{pmatrix}            \bar{\pi}_1 \            \bar{\pi}_2 \            \bar{\pi}_3        \end{pmatrix} =        \begin{pmatrix}            \bar{\pi}_1 \            \bar{\pi}_2 \            \bar{\pi}_3        \end{pmatrix}^\top \begin{pmatrix}            1/2 &amp; 1/4 &amp; 1/4  \            1/4 &amp; 1/4 &amp; 1/2 \            0 &amp; 1/2 &amp; 1/2        \end{pmatrix}        \quad \mathrm{and} \quad \bar{\pi}_1 + \bar{\pi}_2 + \bar{\pi}_3 = 1.    \end{equation}]The solution of this equation is: $\bar{\pi} = \frac{1}{11}(2, 4, 5)$. Hence, the probability that both chains spend time at the same states in a long run is equal to: $\frac{1}{11^2}(4 + 16 + 25) = \frac{45}{121}$.Source: Introduction to Stochastic Processes  Let $X_n$ be a Markov chain on state space {1, 2, 3, 4, 5} with transition matrix[P = \begin{pmatrix}    0 &amp; 1/2 &amp; 1/2 &amp; 0 &amp; 0\    0 &amp; 0 &amp; 0 &amp; 1/5 &amp; 4/5 \    0 &amp; 0 &amp; 0 &amp; 2/5 &amp; 3/5 \    1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \    1/2 &amp; 0 &amp; 0 &amp; 0 &amp; 1/2    \end{pmatrix}](A) Suppose $X_0 = 1$. What is the expected number of steps until the chain is in state 4?(B) Suppose $X_0 = 1$. What is the probability that the chain will enter state 5 before it enters state 3?answer.Part (A).We need to set up a recursive formula connecting the expected number of steps until reaching state 4 for each distinct state. Let $g(i)$ be the expected number of steps until reaching state $4$, when the chain has started at state $i$. We have that $g(4) = 0$. For all other state we have that:[\begin{equation}        g(i) = 1 + \sum_{j=0, j \neq 4}^5P(i, j)g(j).    \end{equation}]This gives a set of 4 equations with 4 unknowns ($g(1), g(2), g(3),\, \mathrm{and}\, g(5)$) as follows:[\begin{align}        g(5) &amp; = 1 + \frac{1}{2}g(0) + \frac{1}{2}g(5) \        g(3) &amp; = 1 + \frac{2}{5}g(4) + \frac{3}{5}g(5) \        g(2) &amp; = 1 + \frac{1}{5}g(4) + \frac{4}{5}g(5) \        g(1) &amp; = 1 + \frac{1}{2}g(2) + \frac{1}{2}g(3)    \end{align}]Solving this system of equations gives us: $g(1) = \frac{34}{3}$.Part (B).We need to set up a recursive formula connecting how the chain can hit state 5 before state 3, while starting at state 1.Let $h(i)$ be the probability that the chain hits state $5$ before state 3, when the chain has started at state $i$. We have that $h(5) =1$ and $h(3) = 0$. For all other state we have that:[\begin{equation}        h(i) = \sum_{j=1}^5P(i, j)h(j).    \end{equation}]This gives a set of 3 equations with 3 unknowns ($h(1), h(2),\, \mathrm{and}\, h(4)$) as follows:[\begin{align}        h(4) &amp; = h(1) \        h(2) &amp; = \frac{1}{5}h(4) + \frac{4}{5}h(5) =  \frac{1}{5}h(4) + \frac{4}{5}\        h(1) &amp; = \frac{1}{2}h(2) + \frac{1}{2}h(3) = \frac{1}{2}h(2)    \end{align}]Solving this system of equations gives us: $h(1) = \frac{4}{9}$.Source: Introduction to Stochastic Processes  Theorem. Suppose the state space $S$ and the action space $A$ are finite. Then, there exits a deterministic stationary Markov Blackwell optimal policy.Proof. Let $\Pi^\mathrm{MD}$ be the set of all deterministic Markov polices for an MDP with finite state and action spaces. Since $\Pi^\mathrm{MD}$ is finite, there exits a sequence of discount factors {$\gamma_n$} converging to one for which there exits a $\pi^* \in \Pi^\mathrm{MD}$ with $\left(\pi^*\right)^\infty = (\pi, \pi, \dots)  = (\pi_0, \pi_1, \dots)$ (as the stationary policy) being discount optimal for all $\gamma_n$.The reason the aforementioned fact is true is that since $\Pi^\mathrm{MD}$ finite and $0 \leq \gamma &lt;1$ is infinite, due to pigeonhole principle some optimal policies are shared for some discount factors. Therefore, we can pick a subsequence of discount factors that increases toward one, which will have an associated optimal policy.With having the above fact in mind, for each $\pi \in \Pi^\mathrm{MD}$,[v_\gamma^{\left(\pi^*\right)^\infty}(s) - v_\gamma^{\pi^\infty}(s) \geq 0,]for all states, $\gamma = \gamma_n$ and $n = 1, 2, \dots$ . Each function on L.H.S. is a rational function of $\gamma$, so is their difference. Hence, the difference is zero for all $\gamma$, or equals zero for at most finitely many $\gamma$s. Therefore, there exists a $\gamma_\pi &lt; 1$ for which the above display holds for $\gamma_\pi \leq \gamma &lt; 1$. Since $\Pi^\mathrm{MD}$ is finite the above displays holds for all $\gamma^* \leq \gamma &lt; 1$ where $\gamma^* = \max_\pi \gamma_{\pi}$.Now that we have fixed $\gamma$, by virtue of the existence of a deterministic stationary Markov policy in the discounted setting, the result follows. $\square$I’ve been concise and incomplete for this theorem. I’ll add supplementary details one day that I stumbled on this post. :DSource: Markov Decision Processes: Discrete Stochastic Dynamic Programming  Let $\Omega$ be a measurable set, and let $f: \Omega \to [0, \infty]$ be a non-negative measurable function. Prove that we have $0 \leq \int_\Omega f \leq \infty$. Furthermore, we have $\int_\Omega f = 0$ if and only if $f(x) = 0$ for almost every $x \in \Omega$.Proof. Since $f$ is a non-negative measurable function, we have that[\int_\Omega f = \sup {\int_\Omega s: s \text{ is non-negative, simple and dominated by } f }.]Step 1: $0 \leq \int_\Omega \leq \infty$.Consider a fixed $s$. Since $s$ is simple, $\int_\Omega s = \sum_{j = 1}^N c_j \cdot m(E_j)$, where $N \in \mathbb{N}, c_j &gt; 0, m: \Omega \to \mathbb{R}^*$ is the Lebesgue measure, $E_1, \dots, E_N \in  \Omega$, and $E_i \cap E_j = \varnothing$ for all $i, j \in [N], \mathrm{and}\, i \neq j$. The sum of non-negative terms on theextended real line $\mathbb{R}^*$ is in $[0, \infty]$, hence is their supremum.Step 2: If $f = 0$ a.e., then $\int_\Omega f = 0$.Since $f$ dominates $s$, then $0 \leq s(x) \leq f(x)$, for all $x \in \Omega$. If $f(x) = 0$ for almost every $x \in \Omega$, then $s = 0$ a.e., hence $\int_\Omega s = 0$, and consequently $\sup \int_\Omega s = 0$.Step 3: If $\int_\Omega f = 0$, then $f = 0$ a.e.Consider the set[E_j := {x \in \Omega: f(x) &gt; \frac 1j }, \quad j \geq 1.]The function $s_j := \frac 1j \mathbb{1}_{E_j}$ is simple and also dominated by $f$ because $0 \leq s_j \leq f$. By Step 1, we have $\frac 1j m(E_j) = \int_\Omega s_j \leq \int_\Omega f = 0$. This means $m(E_j) = 0$ for all $j$. The domain of $f$ where it is non zero is[\Omega’ := {x : f(x) &gt; 0 } = \cup_{j = 1}^\infty E_j.]By the subadditivity property of the Lebesgue measure we have[m\left(\Omega’ \right) = \sum_{j = 1}^\infty m(E_j) = 0 \Rightarrow f = 0: \mathrm{a.e.}]Source: Analysis II">
    <meta itemprop="datePublished" content="October 31, 2025">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Some cool questions
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  27 minute read
	
</p>
          
        
        
        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2025-10-31T00:00:00-07:00">October 31, 2025</time></p>
        
        
             
        
    
        </header>
      

      <section class="page__content" itemprop="text">
        
<p>\(\begin{align*}  
\newcommand{\I}{\mathbb{1}}  
\newcommand{\R}{\mathbb{R}}  
\newcommand{\Q}{\mathbb{Q}}  
\newcommand{\N}{\mathbb{N}}  
\DeclareMathOperator{\EE}{\mathbb{E}}  
\DeclareMathOperator{\PP}{\mathbb{P}}  
\newcommand{\Ev}[1]{\EE\left[ #1 \right]}  
\newcommand{\Pr}[1]{\PP\left( #1 \right)}  
\end{align*}\)</p>
<ul>
  <li>An elementary theorem in number theory states that if two integers $m$ and $n$ are relatively prime (i.e., greatest common divisor equal to 1 ), then there exist integers $x$ and $y$ (positive or negative) such that $mx + ny = 1$. Using this theorem show the following:          <br />
  A If $m$ and $n$ are relatively prime then the set {$xm + ny : x, y$ positive integers} contains all but a finite number of the positive integers.          <br />
  B. Let $J$ be a set of nonnegative integers whose greatest common divisor is $d$. Suppose also that $J$ is closed under addition, $m, n \in J \Rightarrow m + n \in J$. Then $J$ contains all but a finite number of integers in the set {$0, d, 2d,\dots$}.</li>
</ul>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<p><em>answer</em>.</p>

<p>Part (A).</p>

<p>First, note that if we want to contain only positive integers, then $n$ and $m$ must be nonnegative. If one of them is negative and the other is positive, we would inevitably contain the whole integers. Also, to rule out the trivial case, let us assume $n, m \geq 1$.</p>

<p>Since $\mathsf{gcd} (n, m) = 1$, the great common divisor of any multiples of $n$ from $1n$ to $mn$ with $m$ is also one. In other words, the set {$n, 2n, \dots, mn$} forms the residue system modulo $m$. Let $N$ be any nonzero integer, we have $N \equiv ny \pmod m$, where $1 \leq y \leq m$. Equivalently, we can say $N - ny = mx$ for some integer $x$.</p>

<p>We know that since $1 \leq y \leq m$, $y$ is positive. On the other hand, if $N \geq mn + 1$, then $x = \frac{N - ny}{m} &gt; 0$, hence $x$ is also positive. Therefore, we just proved that for positive integers $x$ and $y$, all positive integers bigger than $mn$ are in the set described in the question.</p>

<p>Part (B).</p>

<p>Consider the set $J’ =$ {$\frac{j}{d} \mid j \in J$}. If we show for any integer $k$ in $J’$ that is bigger than some threshold $K$, all but a finite number of nonnegative integers are in $J’$, then we can conclude for any integer $k$ in $J$ that is bigger than $Kd$, all but a finite number of nonnegative integers are in $J$</p>

<p>By construction, the greatest common divisor of $J’$s elements is one and also $J’$ is closed under addition. Now, consider an arbitrary element in $J’$ and let us denote it by $a$. The set of remainder of $J’$s elements when divided by $a$ is $R = $ {$j’ \pmod{a} \mid j’ \in J’$}. Since the greatest common divisor of $J’$ is one, the greatest common divisor of $R$ is also one. Therefore, $R$ forms the residue system modulo $a$, i.e., $R = $ {$0, 1, \dots a - 1$}, where for each element of $r \in R$ there exits at least one element in $J’$ denoted by $j’_r$ such that $j’_r \equiv r \pmod{a}$. Let us denote the largest representative of these elements by $K$:</p>

\[K = \max \left\{j'_0, j'_1, \dots j'_{a - 1} \right\}.\]

<p>Now we show that any integer bigger than $K$ is in $J’$. Let $k$ be an integer bigger than $K$ and let its remainder when divided by $a$ be $r$, i.e., $k = r \pmod{ a}$. We know that there is an element in $J’$ with same remainder, i.e., $j’_r$, therefore:</p>

\[k = j'_r + c\cdot a,\]

<p>for some integer $c$. Since $k &gt; M$ and $j’_r \leq M$, $k - j’_r &gt; 0$ and $c \cdot a$ is positive multiple of $a$.          <br />
Since $j’_r, a \in J’$, and $J’$ is closed under addition, both $j’_r$ and $c \cdot a = \underbrace{a + a + \dots + a}_{c\, \mathrm{times}}$ are in $J’$.          <br />
Therefore, their sum, $k$, must also be in $J’$. This proves that $J’$ contains all integers greater than $K$.         <br />
Consequently, $J$ contains {$(K + 1)d, (K + 2)d, \dots$}, which completes the proof.</p>

<hr />
<ul>
  <li>What is an ergodic Markov chain?</li>
</ul>

<p><em>answer</em>.</p>

<p>It’s an aperiodic, irreducible, and recurrent Markov chain:</p>

<p>Aperiodic:        <br />
The period of the chain is one.</p>

<p>Irreducible:        <br />
If there is only one communication class, i.e., if for all $i, j$ there exists an $n = n(i,j)$ with $P_n(i,j) &gt; 0$, then the chain is called irreducible.</p>

<p>Recurrent:        <br />
If the chain starts in a transient class (set of states), then with probability one it eventually leaves this class and never returns. Classes with this property are called transient classes and the states are called transient states. Other classes are called recurrent classes with recurrent states. A Markov chain starting in a recurrent class never leaves that class.</p>

<hr />
<ul>
  <li>Why is the left eigenvector of a transition matrix with the eigen value of one equal to the stationary distribution of the Markov chain modelled by the transition matrix?</li>
</ul>

<p><em>answer</em>.</p>

<p>Suppose $\bar{\pi}$ is the stationary distribution and $P$ is the transition matrix. Then, we know that since all rows of $P^\infty$ are the same, then for any initial any probability vector $\bar{v}$ we have</p>

\[\bar{\pi} = \lim_{n \to \infty} \bar{v}P^n.\]

<p>Hence, we have,</p>

<p>\(\bar{\pi} = \lim_{n \to \infty} \bar{v}P^{n + 1} = \left(\lim_{n \to \infty} \bar{v}P^{n}\right)P = \bar{\pi}P.\)        <br />
The above display is a left eigenvector of $P with eigenvalue one.</p>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<hr />
<ul>
  <li>Prove that every state in an irreducible Markov chain has the same period.</li>
</ul>

<p>The period of state $i$ is defined as the greatest common divisor of the set $J_i :=$ {$n \geq 1: P_n(i, i) &gt;0$}. Not that $J_i$ is closed under addition because $P_{n +m} (i, i) = \sum_k P_n(i, k) P_m(k, i) \geq P_n(i, i) P_m(i, i) &gt; 0$. Let $d$ be the greatest common divisor of $J_i$. We have shown before that $J_i$ contains all but a finite number of integers. Hence, $J_i$ contains $md$ for all $m$ greater than some integer $M$.</p>

<p>Let $j$ be another state and $n,m$ such that $P_n(i, j), P_m(j, i) &gt; 0$ (chain is irreducible). Clearly $n + m \in J_i$ and $m + n \in J_j$. If $l \in J_j$, then</p>

\[P_{n+m+l}(i, j) \geq P_{n}(i, j)P_l(j, j)P_m(j, i) &gt; 0.\]

<p>Therefore, $n+m+l \in J_i, J_j$. $d$ used to divide $n + m$, now we showed that it must divide $l$ as well.       <br />
So, we have just shown that if $d $divides every element of $J_i$      <br />
then it divides every element of $J_j$. From this we see that all states have the same period.</p>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<p>—  - Consider the Markov chain with state space {1, 2, 3, 4, 5} and matrix</p>

\[P = \begin{pmatrix}      
0 &amp; 1/3 &amp; 2/3 &amp; 0 &amp; 0 \\      
0 &amp; 0 &amp; 0 &amp; 1/4 &amp; 3/4 \\      
0 &amp; 0 &amp; 0 &amp; 1/2 &amp; 1/2 \\      
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\      
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0      
\end{pmatrix}\]

<p>What are $P_{1000}(2, 1 ), P_{1000}(2, 2), P_{1000}(2, 4)$?</p>

<p>Due to the structure of the chain at no time step there would be probability for transitioning from state 2 to state 1, nor from state 2 to itself. Hence, $P_{1000}(2, 1) = P_{1000}(2, 2) = 0$</p>

<p>On the other hand to compute $P_{1000}(2, 4)$, since the chain is periodic with the period of three and the remainder of $1000$ when divided by $3$ is one, the same as number $4$, hence using Python software we raise the matrix to the power of $4$ instead, and $P_{1000}(2, 4) \approx P_4(2, 4) \approx  0.4167$.</p>

\[\begin{equation*}      
    P_4 = \begin{pmatrix}      
  0 &amp; 0.3333 &amp; 0.6665 &amp; 0 &amp; 0\\      
  0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835 \\      
  0 &amp; 0 &amp; 0 &amp; 0.4167 &amp; 0.5835\\      
  1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\      
  1 &amp; 0 &amp; 0 &amp; 0 &amp; 0       
    \end{pmatrix}      
\end{equation*}\]

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<hr />
<ul>
  <li>Let $X_1, X_2,\dots$ be the successive values from independent rolls of a standard six-sided die. Let $S_n= X_1 + \dots + X_n$. Let</li>
</ul>

\[T_1 = \min \{n \geq 1: S_n \, \text{is divisible by 8} \},\]

\[T_2 = \min\{n \geq 1: S_{n - 1}\, \text{is divisible by 8}\}.\]

<p>Find $\mathbb{E}[T_1]$ and $\mathbb{E}[T_2]$. (Hint: consider the remainder of $S_n after division by 8 as a Markov chain.)</p>

<p><em>answer</em>.</p>

<p>The state space of the chain comprises ${0, 1, 2, 3, 4, 5, 6, 7}$. Let $g(i)$ denotes the expected number of rolls until the chain reaches state zero, while starting at state $i$. We have that $g(0) = 0$. Definitely we won’t reach the state $0$ with just one roll because the outcome would be among $1$ and $6$. Hence,</p>

\[\begin{equation*}      
    \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right).      
\end{equation*}\]

<p>On the other hand,</p>

\[\begin{equation*}      
    \sum_{i=1}^7g(i) = \sum_{i=1}^7 \left(1 + \frac{1}{6}\sum_{j=1}^6 g\left(i + j \bmod{8}\right) \right).      
\end{equation*}\]

<p>That is, the expected number of rolls starting from state $i \neq 0$ is equal to rolling the die and the expected number of rolls of the resulting state. We rearrange the summations to get:</p>

\[\begin{equation*}      
    \sum_{i=1}^7g(i) =  7 + \frac{1}{6}\sum_{j=1}^6\sum_{i=7}^6 g(i + j \bmod{8}).      
\end{equation*}\]

<p>Now for each fixed $j$, $(i + j \bmod{8})$ is a permutation of ${0, 1, 2, 3, 4, 5, 6, 7}$ excluding the number $j$.     <br />
Hence, by denoting $S := \sum_{i = 1}^7 g(i)$, we have:</p>

\[\begin{align*}      
    S = 7 + \frac{1}{6}\sum_{j=1}^6(S - g(j)) \Rightarrow \sum_{j = 1}^6 g(j) = 42.      
\end{align*}\]

<p>Therefore,</p>

\[\begin{equation*}      
    \mathbb{E}[T_1] = 1 + \frac{1}{6}\sum_{i = 1}^6 g(i) = 1 + \frac{1}{6}\left(g(1) + g(2) + g(3) + g(4) + g(5) + g(6)\right) = 8.      
\end{equation*}\]

<p>For computing $\mathbb{E}[T_2]$, we only need to roll the die once, because the sum of the random variables before the first roll is zero, so $S_{1 - 1} = S_0 = 0$, and $0$ is divisible by 8.</p>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<hr />
<ul>
  <li>Let $X_n, Y_n$ be independent Markov chains with state space {$0, 1, 2$} and transition matrix</li>
</ul>

\[P = \begin{pmatrix}      
1/2 &amp; 1/4 &amp; 1/4 \\      
1/4 &amp; 1/4 &amp; 1/2 \\      
0 &amp; 1/2 &amp; 1/2      
\end{pmatrix}.\]

<p>Suppose $X_0 = 0, Y_0 = 2$ and let</p>

\[T = \inf\{n: X_n = Y_n\}.\]

<p>(A) Find $\mathbb{E}[T]$.</p>

<p>(B) What is $\mathbb{P}{X_T = 2}$?</p>

<p>(C) In the long run, what percentage of the time are both chains in the same state?    <br />
[Hint: consider the nine-state Markov chain $Z_n = (X_n, Y_n$).]</p>

<p><em>answer</em>.</p>

<p>Part(A).</p>

<p>We need to set up a recursive formula connecting the expected number of steps until two chains meet.</p>

<p>Let $g(i, j)$ be the expected number of steps until the meeting time, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $g(k, k) = 0,: k \in {0, 1, 2}$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:</p>

\[\begin{equation*}      
    g(i, j) = 1 + \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)g(k, j).      
\end{equation*}\]

<p>This gives a set of 6 equations with 6 unknowns     <br />
($g(0, 1), g(0, 2), g(1, 0), g(1, 2), g(2, 0),\, \mathrm{and}\, g(2, 1)$) as follows:</p>

\[\begin{align*}      
    g(0, 1) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)  \\      
    g(0, 2) &amp; = 1 + \frac{1}{2}g(0, 0) + \frac{1}{4}g(0, 1) + \frac{1}{4}g(0, 2)      
    \\      
    g(1, 0) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \\      
    g(1, 2) &amp; = 1 + \frac{1}{4}g(1, 0) + \frac{1}{4}g(1, 1) + \frac{1}{2}g(1, 2) \\      
    g(2, 0) &amp; = 1 + 0\cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2) \\      
    g(2, 1) &amp; = 1 + 0 \cdot g(2, 0) + \frac{1}{2}g(2, 1) + \frac{1}{2}g(2, 2).      
\end{align*}\]

<p>Solving this system of equations gives us: $g(0, 2) = \frac{118}{35} \approx 3.37$.</p>

<p>Part (B).</p>

<p>We need to set up a recursive formula connecting how the chains can meet at state 2 while starting at state 0 and 2 respectively.</p>

<p>Let $h(i, j)$ be the probability of first meeting at state 2, when ${X_n}$ has started at state $i$ and ${Y_n}$ has started in state $j$. We have that $h(1, 1) = h(0 , 0) = 0$ (first meeting should be at state 2), and $h(2, 2) = 1$. For all other state, since ${X_n}$ and ${Y_n}$ are independent, we have that:</p>

\[\begin{equation*}      
    h(i, j) = \sum_{k=0}^3\sum_{l=0}^3 P(i, k)P(j, l)h(k, j).      
\end{equation*}\]

<p>This gives a set of 6 equations with 6 unknowns ($h(0, 1), h(0, 2), h(1, 0), h(1, 2), h(2, 0),\, \mathrm{and}\, h(2, 1)$) as follows:</p>

\[\begin{align*}      
    h(0, 1) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)  \\      
    h(0, 2) &amp; = \frac{1}{2}h(0, 0) + \frac{1}{4}h(0, 1) + \frac{1}{4}h(0, 2)      
    \\      
    h(1, 0) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \\      
    h(1, 2) &amp; = \frac{1}{4}h(1, 0) + \frac{1}{4}h(1, 1) + \frac{1}{2}h(1, 2) \\      
    h(2, 0) &amp; = 0\cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2) \\      
    h(2, 1) &amp; = 0 \cdot h(2, 0) + \frac{1}{2}h(2, 1) + \frac{1}{2}h(2, 2).      
\end{align*}\]

<p>Solving this system of equations gives us: $h(0, 2) = \frac{15}{28} \approx 0.535$.</p>

<p>Part (C).</p>

<p>Since the chains are independent, we need to multiple their invariant distributions for states ${1, 2, 3}$. Let us find the invariant distribution by solving $\bar{\pi} = \bar{\pi}P$:</p>

\[\begin{equation*}      
    \begin{pmatrix}      
        \bar{\pi}_1 \\      
        \bar{\pi}_2 \\      
        \bar{\pi}_3      
    \end{pmatrix} =      
    \begin{pmatrix}      
        \bar{\pi}_1 \\      
        \bar{\pi}_2 \\      
        \bar{\pi}_3      
    \end{pmatrix}^\top \begin{pmatrix}      
        1/2 &amp; 1/4 &amp; 1/4  \\      
        1/4 &amp; 1/4 &amp; 1/2 \\      
        0 &amp; 1/2 &amp; 1/2      
    \end{pmatrix}      
    \quad \mathrm{and} \quad \bar{\pi}_1 + \bar{\pi}_2 + \bar{\pi}_3 = 1.      
\end{equation*}\]

<p>The solution of this equation is: $\bar{\pi} = \frac{1}{11}(2, 4, 5)$. Hence, the probability that both chains spend time at the same states in a long run is equal to: $\frac{1}{11^2}(4 + 16 + 25) = \frac{45}{121}$.</p>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<hr />
<ul>
  <li>Let $X_n$ be a Markov chain on state space {1, 2, 3, 4, 5} with transition matrix</li>
</ul>

\[P = \begin{pmatrix}      
0 &amp; 1/2 &amp; 1/2 &amp; 0 &amp; 0\\      
0 &amp; 0 &amp; 0 &amp; 1/5 &amp; 4/5 \\      
0 &amp; 0 &amp; 0 &amp; 2/5 &amp; 3/5 \\      
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\      
1/2 &amp; 0 &amp; 0 &amp; 0 &amp; 1/2      
\end{pmatrix}\]

<p>(A) Suppose $X_0 = 1$. What is the expected number of steps until the chain is in state 4?</p>

<p>(B) Suppose $X_0 = 1$. What is the probability that the chain will enter state 5 before it enters state 3?</p>

<p><em>answer</em>.</p>

<p>Part (A).</p>

<p>We need to set up a recursive formula connecting the expected number of steps until reaching state 4 for each distinct state. Let $g(i)$ be the expected number of steps until reaching state $4$, when the chain has started at state $i$. We have that $g(4) = 0$. For all other state we have that:</p>

\[\begin{equation*}      
    g(i) = 1 + \sum_{j=0, j \neq 4}^5P(i, j)g(j).      
\end{equation*}\]

<p>This gives a set of 4 equations with 4 unknowns ($g(1), g(2), g(3),\, \mathrm{and}\, g(5)$) as follows:</p>

\[\begin{align*}      
    g(5) &amp; = 1 + \frac{1}{2}g(0) + \frac{1}{2}g(5) \\      
    g(3) &amp; = 1 + \frac{2}{5}g(4) + \frac{3}{5}g(5) \\      
    g(2) &amp; = 1 + \frac{1}{5}g(4) + \frac{4}{5}g(5) \\      
    g(1) &amp; = 1 + \frac{1}{2}g(2) + \frac{1}{2}g(3)      
\end{align*}\]

<p>Solving this system of equations gives us: $g(1) = \frac{34}{3}$.</p>

<p>Part (B).</p>

<p>We need to set up a recursive formula connecting how the chain can <em>hit</em> state 5 before state 3, while starting at state 1.</p>

<p>Let $h(i)$ be the probability that the chain hits state $5$ before state 3, when the chain has started at state $i$. We have that $h(5) =1$ and $h(3) = 0$. For all other state we have that:</p>

\[\begin{equation*}      
    h(i) = \sum_{j=1}^5P(i, j)h(j).      
\end{equation*}\]

<p>This gives a set of 3 equations with 3 unknowns ($h(1), h(2),\, \mathrm{and}\, h(4)$) as follows:</p>

\[\begin{align*}      
    h(4) &amp; = h(1) \\      
    h(2) &amp; = \frac{1}{5}h(4) + \frac{4}{5}h(5) =  \frac{1}{5}h(4) + \frac{4}{5}\\      
    h(1) &amp; = \frac{1}{2}h(2) + \frac{1}{2}h(3) = \frac{1}{2}h(2)      
\end{align*}\]

<p>Solving this system of equations gives us: $h(1) = \frac{4}{9}$.</p>

<p>Source: <a href="https://archive.org/details/introduction-to-stochastic-process-lawler/mode/1up?view=theater">Introduction to Stochastic Processes</a></p>

<hr />
<ul>
  <li><strong>Theorem</strong>. Suppose the state space $S$ and the action space $A$ are finite. Then, there exits a deterministic stationary Markov Blackwell optimal policy.</li>
</ul>

<p><em>Proof</em>. Let $\Pi^\mathrm{MD}$ be the set of all deterministic Markov polices for an MDP with finite state and action spaces. Since $\Pi^\mathrm{MD}$ is finite, there exits a sequence of discount factors {$\gamma_n$} converging to one for which there exits a $\pi^* \in \Pi^\mathrm{MD}$ with $\left(\pi^*\right)^\infty = (\pi, \pi, \dots)  = (\pi_0, \pi_1, \dots)$ (as the stationary policy) being discount optimal for all $\gamma_n$.</p>

<p>The reason the aforementioned fact is true is that since $\Pi^\mathrm{MD}$ finite and $0 \leq \gamma &lt;1$ is infinite, due to pigeonhole principle some optimal policies are shared for some discount factors. Therefore, we can pick a subsequence of discount factors that increases toward one, which will have an associated optimal policy.</p>

<p>With having the above fact in mind, for each $\pi \in \Pi^\mathrm{MD}$,</p>

\[v_\gamma^{\left(\pi^*\right)^\infty}(s) - v_\gamma^{\pi^\infty}(s) \geq 0,\]

<p>for all states, $\gamma = \gamma_n$ and $n = 1, 2, \dots$ . Each function on L.H.S. is a rational function of $\gamma$, so is their difference. Hence, the difference is zero for all $\gamma$, or equals zero for at most finitely many $\gamma$s. Therefore, there exists a $\gamma_\pi &lt; 1$ for which the above display holds for $\gamma_\pi \leq \gamma &lt; 1$. Since $\Pi^\mathrm{MD}$ is finite the above displays holds for all $\gamma^* \leq \gamma &lt; 1$ where $\gamma^* = \max_\pi \gamma_{\pi}$.</p>

<p>Now that we have fixed $\gamma$, by virtue of the existence of a deterministic stationary Markov policy in the discounted setting, the result follows. $\square$</p>

<p>I’ve been concise and incomplete for this theorem. I’ll add supplementary details one day that I stumbled on this post. :D</p>

<p>Source: <a href="https://personalpages.manchester.ac.uk/staff/mingfei.sun/books/mdp.pdf">Markov Decision Processes: Discrete Stochastic Dynamic Programming</a></p>

<hr />
<ul>
  <li>Let $\Omega$ be a measurable set, and let $f: \Omega \to [0, \infty]$ be a non-negative measurable function. Prove that we have $0 \leq \int_\Omega f \leq \infty$. Furthermore, we have $\int_\Omega f = 0$ if and only if $f(x) = 0$ for almost every $x \in \Omega$.</li>
</ul>

<p><em>Proof</em>. Since $f$ is a non-negative measurable function, we have that</p>

\[\int_\Omega f = \sup \{\int_\Omega s: s \text{ is non-negative, simple and dominated by } f \}.\]

<p>Step 1: $0 \leq \int_\Omega \leq \infty$.</p>

<p>Consider a fixed $s$. Since $s$ is simple, $\int_\Omega s = \sum_{j = 1}^N c_j \cdot m(E_j)$, <br />
where $N \in \mathbb{N}, c_j &gt; 0, m: \Omega \to \mathbb{R}^*$ is the Lebesgue measure, $E_1, \dots, E_N \in  \Omega$, <br />
and $E_i \cap E_j = \varnothing$ for all $i, j \in [N], \mathrm{and}\, i \neq j$. The sum of non-negative terms on the<br />
extended real line $\mathbb{R}^*$ is in $[0, \infty]$, hence is their supremum.</p>

<p>Step 2: If $f = 0$ a.e., then $\int_\Omega f = 0$.</p>

<p>Since $f$ dominates $s$, then $0 \leq s(x) \leq f(x)$, for all $x \in \Omega$. If $f(x) = 0$ for almost every $x \in \Omega$, then $s = 0$ a.e., hence $\int_\Omega s = 0$, and consequently $\sup \int_\Omega s = 0$.</p>

<p>Step 3: If $\int_\Omega f = 0$, then $f = 0$ a.e.</p>

<p>Consider the set</p>

\[E_j := \{x \in \Omega: f(x) &gt; \frac 1j \}, \quad j \geq 1.\]

<p>The function $s_j := \frac 1j \mathbb{1}_{E_j}$ is simple and also dominated by $f$ because $0 \leq s_j \leq f$. By Step 1, we have $\frac 1j m(E_j) = \int_\Omega s_j \leq \int_\Omega f = 0$. This means $m(E_j) = 0$ for all $j$. The domain of $f$ where it is non zero is</p>

\[\Omega' := \{x : f(x) &gt; 0 \} = \cup_{j = 1}^\infty E_j.\]

<p>By the subadditivity property of the Lebesgue measure we have</p>

\[m\left(\Omega' \right) = \sum_{j = 1}^\infty m(E_j) = 0 \Rightarrow f = 0\: \mathrm{a.e.}\]

<p>Source: <a href="https://link.springer.com/book/10.1007/978-981-19-7284-3">Analysis II</a></p>

<hr />
<ul>
  <li>Consider two independent Poisson processes $X(t)$ and $Y(t)$ with parameters $\lambda$ and $\mu$. Let $k \geq 1$ and define</li>
</ul>

\[\begin{equation*}
\tau = \inf \{t &gt; 0: X(t) =k \}, \quad \tau' = \inf \{t &gt; 0: X(t) =k + 2\}.
\end{equation*}\]

<p>Find the distribution of $N = Y(\tau’) - Y(\tau)$.</p>

<p><em>Solution</em>. First we need to understand what the question actually asking us. $\tau’ - \tau$
 is the time that it takes for {$X(t)$} to go from $k$ to $k+2$. We can write</p>

\[\begin{equation*}
U := T_{i + 2} - T_{i} = \underbrace{T_{i + 2} - T_{i + 1}}_{U_2} + \underbrace{T_{i + 1} - T_{i}}_{U_1},
\end{equation*}\]

<p>where $T_i = \inf {t &gt; 0: X(t) = i }$. Each $U_i$ represents the arrival time of the $i+1$ “customer” after the fact that the $i$th customer has arrived. Hence, each $U_i$ follows the exponential distribtuion with parameter $\mu$.</p>

<p>The question is asking us how much {$Y(t)$} will increase in the interval between the arrival time of the $k$th and $k+2$ customer at {$X(t)$}. So, we can write that</p>

\[\begin{equation*}
\Pr{N = i \mid U = t} = \Pr{Y(U) = i \mid U = t} = \Pr{Y(t) = i} = e^{-\mu t} \cdot \frac{\left(\mu t\right)^i}{i!}.
\end{equation*}\]

<p>So,</p>

<p>\(\begin{equation*}
\Pr{N = i} = \int_0^\infty \Pr{N = i \mid U = t} f_U(t) dt.
\end{equation*}\)
So, we need the probability mass function of $U$. We said that $U = U_1 + U_2$ and each $U_i$ is comes from an independent exponential distribution. We have,</p>

\[\begin{align*}
f_U(t) &amp;\stackrel{\text{(independence)}}{=} \int_0 ^ tf_{U_1}(x)\cdot f_{U_2}(t - x) dx \\
&amp;= \int_0^t \lambda e^{-\lambda x} \cdot \lambda e^{-\lambda (t - x)} dx \\
&amp; = \lambda^2 te^{-\lambda t}.
\end{align*}\]

<p>Therefore,</p>

\[\begin{align*}
\Pr{N = i} &amp; = \int_0^\infty \Pr{N = i \mid U = t} f_U(t) dt \\
&amp; = \int_0^\infty e^{-\mu t} \frac{\left(\mu t\right)^i}{i!} \cdot \lambda^2 te^{-\lambda t} dt \\
&amp; = \lambda^2\frac{\mu^i}{i!}\int_0^\infty t^{i + 1} \cdot e^{-(\lambda + \mu) t} dt \\
&amp; = \lambda^2\frac{\mu^i}{i!}\int_0^\infty t^{i + 2 - 1} \cdot e^{-(\lambda + \mu) t} dt \\
&amp; = \lambda^2\frac{\mu^i}{i!}\int_0^\infty t^{b - 1} \cdot e^{-a t} dt, \\
\end{align*}\]

<p>where $b = i + 2$ and $a = (\lambda + \mu)$. Let’ see how to compute</p>

\[\begin{equation}
\int_0^\infty t^{b - 1} \cdot e^{-a t} dt.
\end{equation}\]

<p>We know that for $z &gt; 0$, the Gamma function is defined as</p>

\[\begin{equation*}
\Gamma(z) = (z - 1)! = \int_0^\infty t^{z - 1}e^{-t} dt.
\end{equation*}\]

<p>So with athe change of variables $u := at$ we have,</p>

\[\begin{equation}
\int_0^\infty t^{b - 1} \cdot e^{-a t} dt = \int_0^\infty \left(\frac{u}{a}\right)^{b - 1} \cdot e^{-u} \frac{du}{a} = \left(\frac{1}{a^{b + 1}}\right) \int_0^\infty u^{b - 1} \cdot e^{-u} du = \frac{\Gamma(b)}{a^{b + 1}}.
\end{equation}\]

<p>Now replacing $b = i + 2$ and $a = (\lambda + \mu)$,</p>

\[\begin{equation}
\int_0^\infty t^{b - 1} \cdot e^{-a t} dt = \frac{\Gamma(i + 2)}{(\lambda + \mu)^{i + 2}}.
\end{equation}\]

<p>So,</p>

\[\begin{align*}
\Pr{N = i} &amp; = \lambda^2\frac{\mu^i}{i!}\int_0^\infty t^{b - 1} \cdot e^{-a t} dt, \\
&amp; = \lambda^2\frac{\mu^i}{i!} \frac{\Gamma(i + 2)}{(\lambda + \mu)^{i + 2}} \\
&amp; = \lambda^2\frac{\mu^i}{i!} \frac{(i + 1)!}{(\lambda + \mu)^{i + 2}} \\
&amp; = (i + 1)\frac{\lambda^2\mu^i}{(\lambda + \mu)^{i + 2}} \\
&amp; = \binom{i + 2 - 1}{i}\left(\frac{\mu}{\lambda + \mu}\right)^i \left( \frac{\lambda}{\lambda + \mu}\right)^2.
\end{align*}\]

<p>The negative binomial distribution with two success each with the probability of $\frac{\lambda}{ \lambda + \mu}$.</p>

<p>Source: [A question on my midterm at STAT 580 that I couldn’t solve during the exam <em>:)</em>]</p>

<hr />
<ul>
  <li>Let $X_t$ be a Yule process with parameter $\lambda&gt; 0$ and $X_0 =1$. In other words, $X_t$ is birth and death process with the birth rate $\lambda_n = n \lambda$ and the death rate $\mu_n = 0$. Show</li>
</ul>

\[\begin{equation*}
P_n(t) = e^{-\lambda t}\left[1  - e^{-\lambda t}\right]^{n - 1}, \quad n\geq 1.
\end{equation*}\]

<p>Then, assume $X_t, Y_t$ are two independent Yule processes with parameter $\lambda$ and $X_0 = Y_0 = 1$. Determine the conditional distribution of $X_t$ given $X_t + Y_t = N,\; N \geq 2$.</p>

<p><em>Solution.</em> In birth and death processes we have that</p>

\[\begin{align*}
\Pr{X_{t + \Delta t} = n \mid X_t = n} &amp;= 1 - (\lambda_n + \mu_n) \Delta t + o(\Delta t) \\
\Pr{X_{t + \Delta t} = n+1 \mid X_t = n} &amp;= \lambda_n \Delta t + o(\Delta t) \\
\Pr{X_{t + \Delta t} = n-1 \mid X_t = n} &amp;= \mu_n \Delta t + o(\Delta t).
\end{align*}\]

<p>On the other hand, let $P_n(t) = \Pr{X_t =n}$. We have,</p>

\[\begin{align*}
P'_n(t) &amp;= \lim_{\Delta t \to 0} \frac{P_n(t + \Delta t) - P_n(t)}{\Delta t} \\
&amp;= \lim_{\Delta t \to 0} \frac{P_n(t)(1 - \lambda_n + \mu_n)\Delta t + \lambda_{n-1} P_{n - 1}(t) \Delta t + \mu_{n+1} P_{n + 1}(t) \Delta t - P_n(t)}{\Delta t} \\
&amp; \stackrel{(\mu_n = 0)}{=}  \lambda_{n - 1} P_{n - 1}(t) - \lambda_n P_n(t) \\
&amp; \stackrel{(\lambda_n = n\lambda)}{=} (n - 1)\lambda P_{n - 1}(t) - n\lambda P_n(t) \\ 
&amp; \stackrel{\text{(replacing the solution)}}{=} \lambda e^{-\lambda t}\left[ 1 - e^{-\lambda t}\right]^{n - 1}\left(\frac{n - 1}{1 - e^{-\lambda t}}  - n\right) \\
&amp; = \lambda e^{-\lambda t}\left[ 1 - e^{-\lambda t}\right]^{n - 1}\left(\frac{ ne^{-\lambda t} - 1}{1 - e^{-\lambda t}}\right).
\end{align*}\]

<p>Now we take the derivative of the proposed solution:</p>

\[\begin{align*}
-\lambda e^{-\lambda t}\left[1 - e^{-\lambda t}\right]^{n - 1} + (n - 1)\lambda\left[1 - e^{-\lambda t}\right]^{n - 2} e^{-2\lambda t} &amp;= \lambda e^{-\lambda t}\left[ 1 - e^{-\lambda t}\right]^{n - 1} \left(-1 + \frac{e^{-\lambda t}(n - 1)}{1 - e^{-\lambda t}} \right) \\
&amp; = \lambda e^{-\lambda t}\left[ 1 - e^{-\lambda t}\right]^{n - 1} \left(\frac{ne^{-\lambda t} - 1}{1 - e^{-\lambda t}} \right).
\end{align*}\]

<p>For the second part let $q = e^{-\lambda t}$. We have:</p>

\[\begin{align*}
\Pr{X_t = k \mid X_t + Y_t = N} &amp;= \frac{\Pr{X_t = k, X_t + Y_t = N}}{\Pr{X_t + Y_t = N}} \\
&amp;\stackrel{\text{(independence)}}{=} \frac{\Pr{X_t = k}\cdot \Pr{X_t + Y_t = N}}{\Pr{X_t + Y_t = N}} \\
&amp;= \frac{\Pr{X_t = k}\cdot \Pr{Y_t = N - k}}{\sum_{i = 1}^{N - 1} \Pr{X_t = i} \cdot \Pr{Y_t = N - i}} \\
&amp;\stackrel{\text{(part (a))}}{=} \frac{q(1 - q)^{k - 1} \cdot q(1 - q)^{N - k - 1}}{\sum_{i = 1}^{N - 1}q(1 - q)^{i - 1} \cdot q(1 - q)^{N - i - 1}} \\
&amp;= \frac{(1 - q)^{N - 2}}{\sum_{i = 1}^{N - 1}(1 - q)^{N - 2}} = \frac{1}{N - 1}.
\end{align*}\]

<p>The uniform distribution.</p>

<p>Source: [A question on my midterm at STAT 580 that I couldn’t solve during the exam <em>:)</em>]</p>

<hr />


        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://alirezakazemipour.github.io/tags/#learning" class="page__taxonomy-item" rel="tag">learning</a>
    
    </span>
  </p>




      </footer>

      

      


  <nav class="pagination">
    
      <a href="https://alirezakazemipour.github.io/posts/2025/10/cnvrgnc-sprmrtngl/" class="pagination--pager" title="Convergence of Positive Supermartingales
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/alirezakazemipour"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <!-- <li><a href="https://alirezakazemipour.github.io/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li> -->
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Alireza Kazemipour. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    <script src="https://alirezakazemipour.github.io/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  </body>
</html>

